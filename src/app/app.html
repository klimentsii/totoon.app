<div class="converter-container">
  <div class="header">
    <h1>JSON to TOON Converter</h1>
    <div class="model-selector">
      <label>Tokenizer Model:</label>
      <div class="custom-dropdown">
        <button
          type="button"
          class="dropdown-button"
          (click)="toggleDropdown()"
          [class.open]="isDropdownOpen()"
        >
          <span>{{ getSelectedModelLabel() }}</span>
          <svg
            class="dropdown-arrow"
            [class.open]="isDropdownOpen()"
            width="12"
            height="12"
            viewBox="0 0 12 12"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M6 9L1 4h10z" fill="#e0e0e0" />
          </svg>
        </button>
        @if (isDropdownOpen()) {
          <div class="dropdown-menu">
            @for (model of models; track model.value) {
              <button
                type="button"
                class="dropdown-item"
                [class.disabled]="model.disabled"
                [class.selected]="selectedModel() === model.value"
                [disabled]="model.disabled"
                (click)="selectModel(model.value)"
              >
                {{ model.label }}
              </button>
            }
          </div>
        }
      </div>
    </div>
  </div>

  <div class="content">
    <div class="input-section">
      <div class="input-header">
        <label for="json-input">JSON Input <span class="token-count">{{ inputTokens() }} tokens</span></label>
        <div class="buttons">
          <button type="button" class="btn btn-paste" (click)="onPaste()">Paste</button>
          <label for="file-input" class="btn btn-load">
            Load File
            <input
              type="file"
              id="file-input"
              accept=".json,application/json"
              (change)="onFileSelected($event)"
              style="display: none"
            />
          </label>
          <button type="button" class="btn btn-example" (click)="onExample()">Example</button>
        </div>
      </div>
      <textarea
        id="json-input"
        class="textarea-input"
        [class.drag-over]="isDragOver()"
        [value]="jsonInput()"
        (input)="onJsonChange($any($event.target).value)"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        placeholder='Enter JSON, e.g.: {"name": "test", "value": 123}'
      ></textarea>
    </div>

    <div class="output-section">
      <div class="output-header">
        <label for="toon-output">TOON Output <span class="token-count">{{ outputTokens() }} tokens</span></label>
        <div class="buttons">
          <button
            type="button"
            class="btn btn-copy"
            [disabled]="isOutputEmpty()"
            (click)="onCopy()"
          >
            Copy
          </button>
          <button
            type="button"
            class="btn btn-save"
            [disabled]="isOutputEmpty()"
            (click)="onSave()"
          >
            Save
          </button>
          <button
            type="button"
            class="btn btn-save-as"
            [disabled]="isOutputEmpty()"
            (click)="onSaveAs()"
          >
            Save As
          </button>
        </div>
      </div>
      <textarea
        id="toon-output"
        class="textarea-output"
        [value]="toonOutput()"
        (input)="onToonChange($any($event.target).value)"
        placeholder="Conversion result will appear here..."
      ></textarea>
    </div>
  </div>
  <div class="savings-info">
    <div class="savings-item">
      <span class="savings-label">Tokens saved:</span>
      <span class="savings-value">{{ savedTokens() }}</span>
    </div>
    <div class="savings-item">
      <span class="savings-label">Bytes saved:</span>
      <span class="savings-value">{{ savedBytes() }}</span>
    </div>
  </div>
  @if (showCopiedNotification()) {
    <div class="notification">Copied!</div>
  }
</div>
